using site_tenis_para_n1.Models;
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.SqlClient;

namespace site_tenis_para_n1.DAO
{
    public class TenisDAO
    {
        private SqlParameter[] CriaParametros(TenisViewModel tenis)
        {
            SqlParameter[] parametros = new SqlParameter[6];
            parametros[0] = new SqlParameter("id_produto", tenis.IdTenis);
            parametros[1] = new SqlParameter("nome", tenis.Nome);
            parametros[2] = new SqlParameter("categoria", tenis.Categoria);
            parametros[3] = new SqlParameter("valor", tenis.Valor);
            parametros[4] = new SqlParameter("marca", tenis.Marca);
            parametros[5] = new SqlParameter("estoque", tenis.Estoque);
            return parametros;
        }

        public void Inserir(TenisViewModel tenis)
        {
            string sql =
            "insert into cadProdutos(id_produto, nome, categoria, valor, marca, estoque)" +
            "values ( @id_produto, @nome, @categoria, @valor, @marca, @estoque)";
            HelperDAO.ExecutaSQL(sql, CriaParametros(tenis));
        }
        public void Alterar(TenisViewModel tenis)
        {
            string sql =
            "update cadProdutos set nome=@nome," +
            "categoria=@categoria," +
            "valor=@valor," +
            "marca=@marca," +
            "estoque=@estoque where id_produto = @id_produto";
            HelperDAO.ExecutaSQL(sql, CriaParametros(tenis));
        }
        public void Excluir(int id_produto)
        {
            string sql = "delete cadProdutos where id_produto =" + id_produto;
            HelperDAO.ExecutaSQL(sql, null);
        }
        public TenisViewModel Consulta(int id_produto)
        {
            string sql = "select * from cadProdutos where id_produto = " + id_produto;
            DataTable tabela = HelperDAO.ExecutaSelect(sql, null);
            if (tabela.Rows.Count == 0)
                return null;
            else
                return MontaProduto(tabela.Rows[0]);
        }
        public static TenisViewModel MontaProduto(DataRow registro)
        {
            TenisViewModel tenis = new TenisViewModel();
            tenis.IdTenis = Convert.ToInt32(registro["id_produto"]);
            tenis.Nome = registro["nome"].ToString();
            tenis.Categoria = Convert.ToInt32(registro["categoria"]);
            tenis.Valor = Convert.ToDouble(registro["valor"]);
            tenis.Marca = Convert.ToInt32(registro["marca"]);
            tenis.Estoque = Convert.ToInt32(registro["estoque"]); 
            return tenis;
        }

        public List<TenisViewModel> Listagem()
        {
            List<TenisViewModel> lista = new List<TenisViewModel>();

            string sql = "select * from cadProdutos order by nome";
            DataTable tabela = HelperDAO.ExecutaSelect(sql, null);
            foreach (DataRow registro in tabela.Rows)
                lista.Add(MontaProduto(registro));
            return lista;
        }
    }
}

/*

{
public int IdTenis { get; set; }
public int Categoria { get; set; }
public int Marca { get; set; }
public int Estoque { get; set; }
public string Nome { get; set; }
public double Valor { get; set; }

    }
*/
